
> orbit@0.1.0 benchmark
> tsx scripts/benchmark-queries.ts

[dotenv@17.3.1] injecting env (3) from .env.local -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
ğŸš€ Starting Performance Benchmarks

âš ï¸  Make sure the dev server is running (npm run dev)

ğŸ“‹ Step 1: Enrolling a test user...

âœ… User enrolled: cmlrwi4kq0000q9sbhl7em2w3
   Progress initialized: 10 lessons

ğŸ“Š Benchmark 1: Student Enrollment Transaction

   âœ… Enrollment Transaction: 18ms

ğŸ“Š Benchmark 2: Optimized Dashboard Query

   âœ… Dashboard (Optimized): 37ms

ğŸ“Š Benchmark 3: Unoptimized Dashboard Query (For Comparison)

   âœ… Dashboard (Unoptimized): 26ms

ğŸ“Š Benchmark 4: Lessons List

   âœ… Lessons List: 7ms

ğŸ“Š Benchmark 5: Lessons with User Progress

   âœ… Lessons with Progress: 11ms

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    BENCHMARK RESULTS                   
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PASS Enrollment Transaction         18ms
âœ… PASS Dashboard (Optimized)          37ms
âœ… PASS Dashboard (Unoptimized)        26ms
âœ… PASS Lessons List                   7ms
âœ… PASS Lessons with Progress          11ms

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 OPTIMIZATION ANALYSIS                  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Dashboard Query (Optimized):    37ms
Dashboard Query (Unoptimized):  26ms

ğŸ¯ Performance Improvement:      -42.3%
âš¡ Speed Multiplier:              0.7x faster

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   KEY TAKEAWAYS                        
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Optimizations Applied:
   â€¢ Single query with nested select (no N+1)
   â€¢ Field selection (no over-fetching)
   â€¢ Index usage on userId and lesson.order
   â€¢ Client-side aggregation

âŒ Anti-patterns Avoided:
   â€¢ Multiple separate queries (N+1 problem)
   â€¢ Over-fetching with include: true
   â€¢ Full table scans without indexes
   â€¢ Unnecessary data transfer

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

